{% extends 'YosimitsoWorkingForumBundle:Common:base.html.twig' %}
{% block forum %}
    {% include 'YosimitsoWorkingForumBundle:Common:header.html.twig' %}
{% trans_default_domain 'YosimitsoWorkingForumBundle' %}
<script src="{{ asset('bundles/yosimitsoworkingforum/js/jquery.min.js') }}"></script>
<script src="{{ asset('bundles/yosimitsoworkingforum/markdown/js/bootstrap-markdown.js') }}"></script>
<script src="{{ asset('bundles/yosimitsoworkingforum/showdown/src/showdown.js') }}"></script>
<script src="{{ asset('bundles/yosimitsoworkingforum/markdown/locale/bootstrap-markdown.fr.js') }}"></script>
<script src="{{ asset('bundles/yosimitsoworkingforum/showdown/src/extensions/twitter.js') }}"></script>
<link rel="stylesheet" href="{{ asset('bundles/yosimitsoworkingforum/markdown/css/bootstrap.min.css') }}" type="text/css" media="all" />
<link rel="stylesheet" href="{{ asset('bundles/yosimitsoworkingforum/markdown/css/bootstrap-markdown.min.css') }}" type="text/css" media="all" />

<script type="text/javascript" >
   jQuery(document).ready(function() {
      


     jQuery(".textarea_post").markdown({
         language:'{{ app.request.locale }}',
   onPreview: function(e) {
 
    var converter = new Showdown.converter({ extensions: ['twitter'] });
    
    var html  = converter.makeHtml(nl2br(e.getContent()));
   return html;
   }
     });
        });
        
        function nl2br (str, is_xhtml) {
    var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '<br />' : '<br>';
    return (str + '').replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
        }
   
</script>

 <div id="forum_content">
<div class="breadcrumb">
 <a href="{{ path('workingforum_forum')}}">Forum</a> &rarr; <a href="{{ path('workingforum_forum') }}">{{subforum.forum.name}}</a> &rarr; <a href="{{ path('workingforum_subforum',{ 'subforum_slug' : subforum.slug }) }}">{{subforum.name }}</a> &rarr; {{ 'forum.new_thread' | trans }}
</div>
<div class="new_thread">

    <h1>{{ ('forum.new_thread' | trans) }} {{ ('forum.into_forum' | trans) }} <em>{{subforum.name }}</em></h1>    
    <div class="content">
   {% if form_errors(form) %}
                  <div class="alert-error">
                      {{form_errors(form) }}
                  </div>
          {% endif %}
    {{ form_start(form) }}
    <p>{{ 'forum.thread' | trans }}</p>
    <p>{{ form_widget(form.label) }}</p>
    
      <p>{{ 'forum.sublabel' | trans}}</p>
    <p>{{ form_widget(form.sublabel) }}</p>
    
    {% for post in form.post %}
    <p>{{ form_widget(post.content) }}</p>
    {% endfor %}
     <p><input type="submit" value="{{ 'forum.create_thread' | trans }}" class="button width50"/></p>
     {{ form_rest(form) }}
     {{ form_end(form) }}
    </div>   
</div>
 </div>
{% endblock %}
